<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Direto da API</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test { margin: 20px 0; padding: 15px; border: 1px solid #ccc; background: #f9f9f9; }
        pre { background: #000; color: #0f0; padding: 10px; overflow-x: auto; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>üîç Teste Direto da API</h1>
    
    <div class="test">
        <h2>Teste 1: Acesso Direto √† API (com autentica√ß√£o)</h2>
        <p>Clique no link abaixo para ver a resposta raw da API:</p>
        <a href="api/buscar_medicamento.php?q=dip" target="_blank" style="font-size: 18px;">
            üì° api/buscar_medicamento.php?q=dip
        </a>
    </div>
    
    <div class="test">
        <h2>Teste 2: Via Fetch (AJAX)</h2>
        <button onclick="testarAPI()" style="padding: 10px 20px; font-size: 16px;">üöÄ Testar Fetch</button>
        <div id="resultado" style="margin-top: 10px;"></div>
    </div>
    
    <script>
    async function testarAPI() {
        const resultDiv = document.getElementById('resultado');
        resultDiv.innerHTML = '<p>‚è≥ Carregando...</p>';
        
        try {
            console.log('Fazendo requisi√ß√£o...');
            const response = await fetch('api/buscar_medicamento.php?q=dip');
            
            console.log('Status:', response.status);
            console.log('Headers:', [...response.headers.entries()]);
            
            const text = await response.text();
            console.log('Response text:', text);
            
            resultDiv.innerHTML = `
                <h3>Resposta Raw:</h3>
                <pre>${text.substring(0, 2000)}</pre>
                <h3>Status HTTP: ${response.status}</h3>
                <h3>Content-Type: ${response.headers.get('content-type')}</h3>
            `;
            
            try {
                const json = JSON.parse(text);
                resultDiv.innerHTML += `<h3 style="color: green;">‚úÖ JSON V√°lido:</h3><pre>${JSON.stringify(json, null, 2)}</pre>`;
            } catch (e) {
                resultDiv.innerHTML += `<h3 class="error">‚ùå Erro ao parsear JSON: ${e.message}</h3>`;
            }
            
        } catch (error) {
            console.error('Erro:', error);
            resultDiv.innerHTML = `<p class="error">‚ùå Erro: ${error.message}</p>`;
        }
    }
    </script>
</body>
</html>